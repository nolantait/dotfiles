#!/bin/bash

# Server IP must be provided
SERVER_IP=""

# Parse command-line arguments
while [[ $# -gt 0 ]]; do
  case $1 in
    --server)
      SERVER_IP="$2"
      shift 2
      ;;
    *)
      echo "Unknown option: $1"
      echo "Usage: $0 --server IP_ADDRESS"
      exit 1
      ;;
  esac
done

# Check if server IP was provided
if [ -z "$SERVER_IP" ]; then
  echo "Error: Server IP is required"
  echo "Usage: $0 --server IP_ADDRESS"
  exit 1
fi

upterm host \
  --server "ssh://${SERVER_IP}:2222" \
  --authorized-keys ~/.ssh/authorized_keys \
  --force-command 'tmux attach -t pair-programming' \
  -- tmux new -t pair-programming
